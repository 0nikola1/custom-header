const e=e=>{const t=new Date;return{time:t.toLocaleTimeString(e,{hour:"2-digit",minute:"2-digit"}),date:t.toLocaleDateString(e,{}),monthNum:t.getMonth()+1,monthNumLZ:String(t.getMonth()+1).padStart(2,0),monthNameShort:t.toLocaleDateString(e,{month:"short"}),monthNameLong:t.toLocaleDateString(e,{month:"long"}),dayNum:t.getDate(),dayNumLZ:String(t.getDate()).padStart(2,0),dayNameShort:t.toLocaleDateString(e,{weekday:"short"}),dayNameLong:t.toLocaleDateString(e,{weekday:"long"}),hours12:t.getHours()>12?t.getHours()-12:t.getHours(),hours12LZ:String(t.getHours()>12?t.getHours()-12:t.getHours()).padStart(2,0),hours24:t.getHours(),hours24LZ:String(t.getHours()).padStart(2,0),minutes:t.getMinutes(),minutesLZ:String(t.getMinutes()).padStart(2,0),year2d:String(t.getFullYear()).substr(-2),year4d:t.getFullYear(),AMPM:t.getHours()>=12?"PM":"AM",ampm:t.getHours()>=12?"pm":"am"}};var t={},o=/d{1,4}|M{1,4}|YY(?:YY)?|S{1,3}|Do|ZZ|([HhMsDm])\1?|[aA]|"[^"]*"|'[^']*'/g,n="[^\\s]+",r=/\[([^]*?)\]/gm,a=function(){};function i(e,t){for(var o=[],n=0,r=e.length;n<r;n++)o.push(e[n].substr(0,t));return o}function s(e){return function(t,o,n){var r=n[e].indexOf(o.charAt(0).toUpperCase()+o.substr(1).toLowerCase());~r&&(t.month=r)}}function c(e,t){for(e=String(e),t=t||2;e.length<t;)e="0"+e;return e}var l=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],d=["January","February","March","April","May","June","July","August","September","October","November","December"],u=i(d,3),h=i(l,3);t.i18n={dayNamesShort:h,dayNames:l,monthNamesShort:u,monthNames:d,amPm:["am","pm"],DoFn:function(e){return e+["th","st","nd","rd"][e%10>3?0:(e-e%10!=10)*e%10]}};var p={D:function(e){return e.getDate()},DD:function(e){return c(e.getDate())},Do:function(e,t){return t.DoFn(e.getDate())},d:function(e){return e.getDay()},dd:function(e){return c(e.getDay())},ddd:function(e,t){return t.dayNamesShort[e.getDay()]},dddd:function(e,t){return t.dayNames[e.getDay()]},M:function(e){return e.getMonth()+1},MM:function(e){return c(e.getMonth()+1)},MMM:function(e,t){return t.monthNamesShort[e.getMonth()]},MMMM:function(e,t){return t.monthNames[e.getMonth()]},YY:function(e){return c(String(e.getFullYear()),4).substr(2)},YYYY:function(e){return c(e.getFullYear(),4)},h:function(e){return e.getHours()%12||12},hh:function(e){return c(e.getHours()%12||12)},H:function(e){return e.getHours()},HH:function(e){return c(e.getHours())},m:function(e){return e.getMinutes()},mm:function(e){return c(e.getMinutes())},s:function(e){return e.getSeconds()},ss:function(e){return c(e.getSeconds())},S:function(e){return Math.round(e.getMilliseconds()/100)},SS:function(e){return c(Math.round(e.getMilliseconds()/10),2)},SSS:function(e){return c(e.getMilliseconds(),3)},a:function(e,t){return e.getHours()<12?t.amPm[0]:t.amPm[1]},A:function(e,t){return e.getHours()<12?t.amPm[0].toUpperCase():t.amPm[1].toUpperCase()},ZZ:function(e){var t=e.getTimezoneOffset();return(t>0?"-":"+")+c(100*Math.floor(Math.abs(t)/60)+Math.abs(t)%60,4)}},m={D:["\\d\\d?",function(e,t){e.day=t}],Do:["\\d\\d?"+n,function(e,t){e.day=parseInt(t,10)}],M:["\\d\\d?",function(e,t){e.month=t-1}],YY:["\\d\\d?",function(e,t){var o=+(""+(new Date).getFullYear()).substr(0,2);e.year=""+(t>68?o-1:o)+t}],h:["\\d\\d?",function(e,t){e.hour=t}],m:["\\d\\d?",function(e,t){e.minute=t}],s:["\\d\\d?",function(e,t){e.second=t}],YYYY:["\\d{4}",function(e,t){e.year=t}],S:["\\d",function(e,t){e.millisecond=100*t}],SS:["\\d{2}",function(e,t){e.millisecond=10*t}],SSS:["\\d{3}",function(e,t){e.millisecond=t}],d:["\\d\\d?",a],ddd:[n,a],MMM:[n,s("monthNamesShort")],MMMM:[n,s("monthNames")],a:[n,function(e,t,o){var n=t.toLowerCase();n===o.amPm[0]?e.isPm=!1:n===o.amPm[1]&&(e.isPm=!0)}],ZZ:["[^\\s]*?[\\+\\-]\\d\\d:?\\d\\d|[^\\s]*?Z",function(e,t){var o,n=(t+"").match(/([+-]|\d\d)/gi);n&&(o=60*n[1]+parseInt(n[2],10),e.timezoneOffset="+"===n[0]?o:-o)}]};m.dd=m.d,m.dddd=m.ddd,m.DD=m.D,m.mm=m.m,m.hh=m.H=m.HH=m.h,m.MM=m.M,m.ss=m.s,m.A=m.a,t.masks={default:"ddd MMM DD YYYY HH:mm:ss",shortDate:"M/D/YY",mediumDate:"MMM D, YYYY",longDate:"MMMM D, YYYY",fullDate:"dddd, MMMM D, YYYY",shortTime:"HH:mm",mediumTime:"HH:mm:ss",longTime:"HH:mm:ss.SSS"},t.format=function(e,n,a){var i=a||t.i18n;if("number"==typeof e&&(e=new Date(e)),"[object Date]"!==Object.prototype.toString.call(e)||isNaN(e.getTime()))throw new Error("Invalid Date in fecha.format");n=t.masks[n]||n||t.masks.default;var s=[];return(n=(n=n.replace(r,(function(e,t){return s.push(t),"@@@"}))).replace(o,(function(t){return t in p?p[t](e,i):t.slice(1,t.length-1)}))).replace(/@@@/g,(function(){return s.shift()}))},t.parse=function(e,n,a){var i=a||t.i18n;if("string"!=typeof n)throw new Error("Invalid format in fecha.parse");if(n=t.masks[n]||n,e.length>1e3)return null;var s={},c=[],l=[];n=n.replace(r,(function(e,t){return l.push(t),"@@@"}));var d,u=(d=n,d.replace(/[|\\{()[^$+*?.-]/g,"\\$&")).replace(o,(function(e){if(m[e]){var t=m[e];return c.push(t[1]),"("+t[0]+")"}return e}));u=u.replace(/@@@/g,(function(){return l.shift()}));var h=e.match(new RegExp(u,"i"));if(!h)return null;for(var p=1;p<h.length;p++)c[p-1](s,h[p],i);var b,y=new Date;return!0===s.isPm&&null!=s.hour&&12!=+s.hour?s.hour=+s.hour+12:!1===s.isPm&&12==+s.hour&&(s.hour=0),null!=s.timezoneOffset?(s.minute=+(s.minute||0)-+s.timezoneOffset,b=new Date(Date.UTC(s.year||y.getFullYear(),s.month||0,s.day||1,s.hour||0,s.minute||0,s.second||0,s.millisecond||0))):b=new Date(s.year||y.getFullYear(),s.month||0,s.day||1,s.hour||0,s.minute||0,s.second||0,s.millisecond||0),b};(function(){try{(new Date).toLocaleDateString("i")}catch(e){return"RangeError"===e.name}})(),function(){try{(new Date).toLocaleString("i")}catch(e){return"RangeError"===e.name}}(),function(){try{(new Date).toLocaleTimeString("i")}catch(e){return"RangeError"===e.name}}();const b=document.querySelector("home-assistant"),y=b.hass,_=function(){var e=document.querySelector("home-assistant");if(e=(e=(e=(e=(e=(e=(e=(e=e&&e.shadowRoot)&&e.querySelector("home-assistant-main"))&&e.shadowRoot)&&e.querySelector("app-drawer-layout partial-panel-resolver"))&&e.shadowRoot||e)&&e.querySelector("ha-panel-lovelace"))&&e.shadowRoot)&&e.querySelector("hui-root")){var t=e.lovelace;return t.current_view=e.___curView,t}return null}(),w=function(){var e=document.querySelector("home-assistant");if(e=(e=(e=(e=(e=(e=(e=(e=e&&e.shadowRoot)&&e.querySelector("home-assistant-main"))&&e.shadowRoot)&&e.querySelector("app-drawer-layout partial-panel-resolver"))&&e.shadowRoot||e)&&e.querySelector("ha-panel-lovelace"))&&e.shadowRoot)&&e.querySelector("hui-root"))return e.shadowRoot}(),f={};f.main=b.shadowRoot.querySelector("home-assistant-main"),f.tabs=Array.from((w.querySelector("paper-tabs")||w).querySelectorAll("paper-tab")),f.tabContainer=w.querySelector("paper-tabs"),f.activeTab=w.querySelector("paper-tab.iron-selected"),f.menu=w.querySelector("ha-menu-button"),f.options=w.querySelector("paper-menu-button"),f.voice=w.querySelector("ha-start-voice-button")||w.querySelector('paper-icon-button[icon="hass:microphone"]'),f.drawer=f.main.shadowRoot.querySelector("#drawer"),f.sidebar={},f.sidebar.main=f.main.shadowRoot.querySelector("ha-sidebar"),f.sidebar.menu=f.sidebar.main.shadowRoot.querySelector(".menu"),f.sidebar.listbox=f.sidebar.main.shadowRoot.querySelector("paper-listbox"),f.sidebar.divider=f.sidebar.main.shadowRoot.querySelector("div.divider"),f.appHeader=w.querySelector("app-header"),f.appLayout=w.querySelector("ha-app-layout"),f.partialPanelResolver=f.main.shadowRoot.querySelector("partial-panel-resolver");const g=[];for(const e in f);g.length&&console.log(`[CUSTOM HEADER] The following HA element${g.length>1?"s":""} could not be found: ${g.join(", ")}`);const v=e=>{let t;const{views:o}=_.config;return isNaN(e)?o.forEach(n=>{n.title!==e&&n.path!==e||(t=o.indexOf(n))}):t=parseInt(e,10),t},S=e=>{const t=[],o=(e,t)=>new Array(t-e+1).fill(void 0).map((t,o)=>o+e);if(e.includes("to")){const n=e.split("to");parseInt(n[1])>parseInt(n[0])?t.push(o(parseInt(n[0]),parseInt(n[1]))):t.push(o(parseInt(n[1]),parseInt(n[0])))}return t.flat()},q=e=>{let t=[];e="string"==typeof e?e.replace(/\s+/g,"").split(","):e;for(const o in e)"string"==typeof e[o]&&e[o].includes("to")?t.push(S(e[o])):t.push(e[o]);t=t.flat();for(const e in t)isNaN(t[e])?t[e]=v(t[e]):t[e]=parseInt(t[e]);return t.sort((e,t)=>e-t)},x=e=>{let t={},o=0;return e.exceptions&&e.exceptions.forEach(e=>{const n=(e=>{const t={user:y.user.name,user_agent:navigator.userAgent};let o=0;for(const n in e)if("user"==n&&e[n].includes(","))e[n].split(/[ ,]+/).forEach(e=>{t[n]==e&&o++});else{if(!(t[n]==e[n]||"query_string"==n&&window.location.search.includes(e[n])||"user_agent"==n&&t[n].includes(e[n])||"media_query"==n&&window.matchMedia(e[n]).matches))return 0;o++}return o})(e.conditions);n>o&&(o=n,t=e.config)}),t.hide_tabs&&e.show_tabs&&t.hide_tabs.length&&e.show_tabs.length?delete e.show_tabs:t.show_tabs&&e.hide_tabs&&t.show_tabs.length&&e.hide_tabs.length&&delete e.hide_tabs,{...e,...t}},M=(()=>{if(w.querySelector("ch-header"))return;const e={};e.tabContainer=document.createElement("paper-tabs"),e.tabContainer.setAttribute("scrollable",""),e.tabContainer.setAttribute("dir","ltr"),e.tabContainer.style.width="100%",e.tabContainer.style.marginLeft="0",f.tabs.forEach(t=>{const o=f.tabs.indexOf(t),n=t.cloneNode(!0),r=n.querySelector("ha-icon");r&&r.setAttribute("icon",_.config.views[o].icon),n.addEventListener("click",()=>{f.tabs[o].dispatchEvent(new MouseEvent("click",{bubbles:!1,cancelable:!0}))}),e.tabContainer.appendChild(n)}),e.tabs=e.tabContainer.querySelectorAll("paper-tab");const t=(t,o)=>{if("options"===t){e[t]=f[t].cloneNode(!0),e[t].removeAttribute("horizontal-offset"),e[t].querySelector("paper-icon-button").style.height="48px";const o=Array.from(e[t].querySelectorAll("paper-item"));o.forEach(e=>{const n=o.indexOf(e);e.addEventListener("click",()=>{f[t].querySelectorAll("paper-item")[n].dispatchEvent(new MouseEvent("click",{bubbles:!1,cancelable:!0}))})})}else{if(!f[t])return;e[t]=document.createElement("paper-icon-button"),e[t].addEventListener("click",()=>{(f[t].shadowRoot.querySelector("paper-icon-button")||f[t]).dispatchEvent(new MouseEvent("click",{bubbles:!1,cancelable:!0}))})}e[t].setAttribute("icon",o),e[t].setAttribute("buttonElem",t),e[t].style.flexShrink="0",e[t].style.height="48px"};t("menu","mdi:menu"),t("voice","mdi:microphone"),t("options","mdi:dots-vertical");const o=document.createElement("ch-stack"),n=document.createElement("div");return n.setAttribute("id","contentContainer"),e.container=document.createElement("ch-header"),e.menu&&e.container.appendChild(e.menu),e.container.appendChild(o),e.stack=e.container.querySelector("ch-stack"),e.stack.appendChild(n),e.stack.appendChild(e.tabContainer),e.voice&&"hidden"!=e.voice.style.visibility&&e.container.appendChild(e.voice),e.options&&e.container.appendChild(e.options),f.appLayout.appendChild(e.container),e})(),R=(e,t,o)=>{const n=(e,t)=>{let o;const n=document.querySelector("home-assistant").hass;return o="raw_editor"===t?n.localize("ui.panel.lovelace.editor.menu.raw_editor"):"unused_entities"==t?n.localize("ui.panel.lovelace.unused_entities.title"):n.localize(`ui.panel.lovelace.menu.${t}`),e.innerHTML.includes(o)||e.getAttribute("aria-label")==o};(o?document.querySelector("home-assistant").shadowRoot.querySelector("home-assistant-main").shadowRoot.querySelector("ha-panel-lovelace").shadowRoot.querySelector("hui-root").shadowRoot.querySelector("app-toolbar > paper-menu-button"):t.options).querySelector("paper-listbox").querySelectorAll("paper-item").forEach(t=>{e.hide_help&&n(t,"help")||e.hide_unused&&n(t,"unused_entities")||e.hide_refresh&&n(t,"refresh")||e.hide_config&&n(t,"configure_ui")||e.hide_raw&&n(t,"raw_editor")?t.style.display="none":t.style.display=""})},C=(e,t,o,n)=>{o.options.querySelector(`#${e.toLowerCase()}_dropdown`)&&o.options.querySelector(`#${e.toLowerCase()}_dropdown`).remove();const r=document.createElement("paper-item"),a=document.createElement("ha-icon");r.setAttribute("id",`${e.toLowerCase()}_dropdown`),a.setAttribute("icon",n.button_icons[e.toLowerCase()]||t),a.style.pointerEvents="none","rtl"===n.button_direction?a.style.marginLeft="auto":a.style.marginRight="auto",r.innerText=e,r.appendChild(a),r.addEventListener("click",()=>{o[e.toLowerCase()].click()}),a.addEventListener("click",()=>{o[e.toLowerCase()].click()}),o.options.querySelector("paper-listbox").appendChild(r)},E=e=>{if(window.location.href.includes("disable_ch"))return;let t=document.createElement("style");t.setAttribute("id","ch_header_style"),t.innerHTML+="\n        #drawer {\n          display: none;\n        }\n      ",e||(t.innerHTML+="\n        ch-header {\n          display: none;\n        }\n        app-header {\n          display: none;\n        }\n        hui-view, hui-panel-view {\n          min-height: 100vh;\n        }\n      ");const o=w.querySelector("#ch_header_style");o&&o.innerText==t.innerHTML||(w.appendChild(t),o&&o.remove()),f.drawer.style.display="none",f.sidebar.main.shadowRoot.querySelector("#ch_sidebar_style")||((t=document.createElement("style")).setAttribute("id","ch_sidebar_style"),t.innerHTML=":host(:not([expanded])) {width: 0px !important;}",f.sidebar.main.shadowRoot.appendChild(t)),f.main.shadowRoot.querySelector("#ch_sidebar_style")||((t=document.createElement("style")).setAttribute("id","ch_sidebar_style"),t.innerHTML=":host {--app-drawer-width: 0px !important;}",f.main.shadowRoot.appendChild(t)),window.dispatchEvent(new Event("resize"))},H=()=>{f.drawer.style.display="";let e=f.main.shadowRoot.querySelector("#ch_sidebar_style");e&&e.remove(),(e=f.sidebar.main.shadowRoot.querySelector("#ch_sidebar_style"))&&e.remove(),f.drawer.style.display=""},D=e=>{if(window.customHeaderConfig=e,window.location.href.includes("disable_ch")&&(e.disabled_mode=!0),e.disabled_mode)return window.customHeaderDisabled=!0,H(),M.container&&(M.container.style.visibility="hidden"),w.querySelector("#ch_header_style")&&w.querySelector("#ch_header_style").remove(),w.querySelector("#ch_view_style")&&w.querySelector("#ch_view_style").remove(),M.tabContainer.shadowRoot.querySelector("#ch_chevron")&&M.tabContainer.shadowRoot.querySelector("#ch_chevron").remove(),M.menu.style.display="none",w.querySelector("ha-menu-button").style.display="",f.sidebar.main.shadowRoot.querySelector(".menu").style="",f.sidebar.main.shadowRoot.querySelector("paper-listbox").style="",f.sidebar.main.shadowRoot.querySelector("div.divider").style="",void window.dispatchEvent(new Event("resize"));if(window.customHeaderDisabled=!1,R(e,M,!1),M.menu.style.display="",M.container&&(M.container.style.visibility="visible"),M.tabs.length||(e.compact_mode=!1),e.menu_dropdown&&!e.disable_sidebar?C("Menu","mdi:menu",M,e):M.options.querySelector("#menu_dropdown")&&M.options.querySelector("#menu_dropdown").remove(),e.voice_dropdown?C("Voice","mdi:microphone",M,e):M.options.querySelector("#voice_dropdown")&&M.options.querySelector("#voice_dropdown").remove(),"rtl"==e.button_direction?(M.options.setAttribute("horizontal-align","left"),M.options.querySelector("paper-listbox").setAttribute("dir","ltr")):(M.options.setAttribute("horizontal-align","right"),M.options.querySelector("paper-listbox").setAttribute("dir","rtl")),e.disable_sidebar?E(!0):e.disable_sidebar||e.kiosk_mode||(H(),f.sidebar.main.shadowRoot.querySelector(".menu").style="height:49px;",f.sidebar.main.shadowRoot.querySelector("paper-listbox").style="height:calc(100% - 155px);",f.sidebar.main.shadowRoot.querySelector("div.divider").style="margin-bottom: -10px;"),(e=>{let t=48;e.compact_mode||("rtl"==e.button_direction?(M.container.querySelector("#contentContainer").dir="ltr",M.container.querySelector("#contentContainer").style.textAlign="right"):(M.container.querySelector("#contentContainer").style.textAlign="",M.container.querySelector("#contentContainer").dir=""),M.container.querySelector("#contentContainer").innerHTML=e.header_text,t=M.tabs.length?96:48);let o=document.createElement("style");o.setAttribute("id","ch_header_style"),o.innerHTML=`\n      ch-header {\n        padding-left: 10px;\n        padding-right: 10px;\n        box-sizing: border-box;\n        display:flex;\n        justify-content: center;\n        font: 400 20px Roboto, sans-serif;\n        background: ${e.background||"var(--primary-color)"};\n        color: ${e.elements_color||"var(--text-primary-color)"};\n        margin-top: 4px;\n        margin-bottom: 0px;\n        margin-top: ${e.footer_mode?"4px;":"0px"};\n        ${e.footer_mode?"position: sticky; bottom: 0px;":"position: sticky; top: 0px;"}\n        ${e.header_css?e.header_css:""}\n      }\n      ch-stack {\n        flex-direction: column;\n        width: 100%;\n        margin-left: 9px;\n        margin-right: 9px;\n        ${e.stack_css?e.stack_css:""}\n      }\n      #contentContainer {\n        padding: 12px 6px 12px 6px;\n        color: var(--text-primary-color);\n        ${e.compact_mode?"display: none;":""}\n        ${e.header_text_css?e.header_text_css:""}\n      }\n      app-header {\n        display: none;\n      }\n      paper-tab.iron-selected {\n        ${e.active_tab_color?`color: ${e.active_tab_color};`:""}\n        ${e.active_tab_css?e.active_tab_css:""}\n      }\n      [buttonElem="menu"] {\n        ${e.menu_color?`color: ${e.menu_color};`:""}\n        ${e.menu_hide?"display: none;":""}\n        ${e.menu_css?e.menu_css:""}\n      }\n      [buttonElem="options"] {\n        ${e.options_color?`color: ${e.options_color};`:""}\n        ${e.options_hide?"display: none;":""}\n        ${e.options_css?e.options_css:""}\n      }\n      [buttonElem="voice"] {\n        ${e.voice_color?`color: ${e.voice_color};`:""}\n        ${e.voice_hide?"display: none;":""}\n        ${e.voice_css?e.voice_css:""}\n      }\n      paper-tab {\n        ${e.all_tabs_color?`color: ${e.all_tabs_color};`:""}\n        ${e.all_tabs_css?e.all_tabs_css:""}\n      }\n      paper-tabs {\n        ${e.tab_indicator_color?`--paper-tabs-selection-bar-color: ${e.tab_indicator_color} !important;`:""}\n        ${e.tab_container_css?e.tab_container_css:""}\n      }\n    `,e.tabs_color&&Object.keys(e.tabs_color).forEach(t=>{o.innerHTML+=`\n        paper-tab:nth-child(${v(t)+1}) {\n          color: ${e.tabs_color[t]};\n        }\n      `}),e.hide_tabs&&e.hide_tabs.forEach(e=>{o.innerHTML+=`\n        paper-tab:nth-child(${v(e)+1}) {\n          display: none;\n        }\n      `}),e.tabs_css&&Object.keys(e.tabs_css).forEach(t=>{o.innerHTML+=`\n        paper-tab:nth-child(${v(t)+1}) {\n          ${e.tabs_css[t]};\n        }\n      `});let n=w.querySelector("#ch_header_style");w.appendChild(o),n&&n.remove(),(o=document.createElement("style")).setAttribute("id","ch_view_style"),o.innerHTML=`\n        hui-view, hui-panel-view {\n          min-height: calc(100vh - ${t}px);\n          padding-top: 2px;\n          ${e.footer_mode?`padding-bottom: ${t}px;`:""}\n          ${e.footer_mode?`margin-bottom: -${t+4}px;`:""}\n        }\n        hui-panel-view {\n          padding-top: 0px;\n          ${e.panel_view_css?e.panel_view_css:""}\n        }\n        hui-view {\n          padding-top: 0px;\n          ${e.view_css?e.view_css:""}\n        }\n        #view {\n          ${e.footer_mode?`min-height: calc(100vh - ${t+4}px) !important;`:""}\n        }\n      `,(n=w.querySelector("#ch_view_style"))&&o.innerHTML==n.innerHTML||(w.appendChild(o),n&&n.remove()),(o=document.createElement("style")).setAttribute("id","ch_chevron"),o.innerHTML='\n      .not-visible[icon*="chevron"] {\n        display:none;\n      }\n    ',n=M.tabContainer.shadowRoot.querySelector("#ch_chevron"),M.tabContainer.shadowRoot.appendChild(o),n&&n.remove()})(e),e.chevrons?M.tabContainer.hideScrollButtons=!1:M.tabContainer.hideScrollButtons=!0,e.indicator_top?M.tabContainer.alignBottom=!0:M.tabContainer.alignBottom=!1,e.footer_mode?M.options.setAttribute("vertical-align","bottom"):M.options.removeAttribute("vertical-align"),e.footer_mode?M.container.removeAttribute("slot"):M.container.setAttribute("slot","header"),M.tabContainer.dir=e.tab_direction,M.container.dir=e.button_direction,e.tab_icons&&M.tabs.length)for(const t in e.tab_icons){const o=v(t),n=M.tabs[o].querySelector("ha-icon");e.tab_icons[t]?n.icon=e.tab_icons[t]:n.icon=_.config.views[o].icon}if(e.button_icons)for(const t in e.button_icons)e.button_icons[t]?"options"===t?M[t].querySelector("paper-icon-button").icon=e.button_icons[t]:M[t].icon=e.button_icons[t]:"menu"===t?M.menu.icon="mdi:menu":"voice"===t?M.voice.icon="mdi:microphone":"options"===t&&(M[t].querySelector("paper-icon-button").icon="mdi:dots-vertical");if(e.button_text)for(const t in e.button_text){const o=document.createElement("p");o.className="buttonText";const n="options"===t?M[t].querySelector("paper-icon-button"):M[t];e.button_text[t]||!n.shadowRoot.querySelector(".buttonText")?e.button_text[t]&&(n.shadowRoot.querySelector(".buttonText")?n.shadowRoot.querySelector(".buttonText").innerText=e.button_text[t]:(o.innerText=e.button_text[t],n.shadowRoot.appendChild(o)),"rtl"==e.button_direction?n.shadowRoot.querySelector(".buttonText").dir="ltr":n.shadowRoot.querySelector(".buttonText").dir="",n.shadowRoot.querySelector("iron-icon").style.display="none",n.style.width="auto",n.shadowRoot.querySelector(".buttonText").style.margin="5.5px 0px 0px 0px"):(n.shadowRoot.querySelector(".buttonText").remove(),n.shadowRoot.querySelector("iron-icon").style.display="",n.style.width="")}((e,t)=>{const o=f.sidebar.listbox.querySelector('[data-panel="lovelace"]');if(e.hide_tabs.includes(0)&&!e.default_tab){for(const e of t.tabs)if("none"!=getComputedStyle(e).display){o.setAttribute("href",`/lovelace/${t.tabContainer.indexOf(e)}`);break}}else e.hide_tabs.includes(0)&&o.setAttribute("href",`/lovelace/${v(e.default_tab)}`);const n=null!=e.default_tab?v(e.default_tab):null;if(e.hidden_tab_redirect&&t.tabs.length){const r=t.tabContainer.indexOf(t.tabContainer.querySelector("paper-tab.iron-selected"));if(e.hide_tabs.includes(r)&&e.hide_tabs.length!=t.tabs.length)if(n&&!e.hide_tabs.includes(v(n)))"none"!=getComputedStyle(t.tabs[n]).display&&(t.tabs[n].click(),o.setAttribute("href",`/lovelace/${n}`));else for(const e of t.tabs)if("none"!=getComputedStyle(e).display){e.click(),o.setAttribute("href",`/lovelace/${t.tabContainer.indexOf(e)}`);break}}null!=n&&!window.customHeaderDefaultClicked&&t.tabs[n]&&"none"!=getComputedStyle(t.tabs[n]).display&&t.tabs[n].click(),window.customHeaderDefaultClicked=!0})(e,M),M.tabs.length||(M.tabContainer.style.display="none"),((e,t)=>{if(e.menu_hide)return;const o=()=>{const t=document.createElement("div");return t.className="dot",t.style.cssText=`\n        pointer-events: none;\n        position: relative;\n        background-color: ${e.notification_dot_color};\n        width: 12px;\n        height: 12px;\n        top: -28px;\n        right: ${"rtl"==e.button_direction?"":"-"}16px;\n        border-radius: 50%;\n    `,t},n=()=>{e.disable_sidebar||window.customHeaderDisabled||("hidden"===f.menu.style.visibility?t.menu.style.display="none":t.menu.style.display="initial")},r=e=>{const t=document.querySelector("home-assistant").shadowRoot.querySelector("home-assistant-main").shadowRoot.querySelector("ha-panel-lovelace").shadowRoot.querySelector("hui-root");e.forEach(({addedNodes:e,removedNodes:n})=>{if(e)for(const n of e)"dot"!==n.className||t.shadowRoot.querySelector('[buttonElem="menu"]').shadowRoot.querySelector(".dot")||t.shadowRoot.querySelector('[buttonElem="menu"]').shadowRoot.appendChild(o());if(n)for(const e of n)"dot"===e.className&&t.shadowRoot.querySelector('[buttonElem="menu"]').shadowRoot.querySelector(".dot")&&t.shadowRoot.querySelector('[buttonElem="menu"]').shadowRoot.querySelector(".dot").remove()})};if(!window.customHeaderMenuObserver){window.customHeaderMenuObserver=!0,new MutationObserver(r).observe(f.menu.shadowRoot,{childList:!0}),new MutationObserver(n).observe(f.menu,{attributes:!0,attributeFilter:["style"]})}n();const a=t.menu.shadowRoot.querySelector(".dot");a&&a.style.cssText!=o().style.cssText&&a.remove(),!t.menu.shadowRoot.querySelector(".dot")&&f.menu.shadowRoot.querySelector(".dot")&&t.menu.shadowRoot.appendChild(o())})(e,M),window.dispatchEvent(new Event("resize"))},$=e=>getComputedStyle(document.body).getPropertyValue(e),A={locale:[],header_text:"Home Assistant",disabled_mode:!1,kiosk_mode:!1,compact_mode:!1,footer_mode:!1,disable_sidebar:!1,chevrons:!0,indicator_top:!1,hidden_tab_redirect:!0,sidebar_right:!1,background:$("--ch-background")||"var(--primary-color)",elements_color:$("--ch-elements-color")||"var(--text-primary-color)",menu_color:$("--ch-menu-color")||"",voice_color:$("--ch-voice-color")||"",options_color:$("--ch-options-color")||"",all_tabs_color:$("--ch-all-tabs-color")||"",notification_dot_color:$("--ch-notification-dot-color")||"#ff9800",tab_indicator_color:$("--ch-tab-indicator-color")||"",active_tab_color:$("--ch-active-tab-color")||"",tabs_color:[],hide_tabs:[],show_tabs:[],default_tab:0,tab_icons:[],tab_direction:"ltr",button_icons:[],button_direction:"ltr",menu_dropdown:!1,menu_hide:!1,voice_dropdown:!1,voice_hide:!1,options_hide:!1,hide_help:!1,hide_unused:!1,hide_refresh:!1,hide_config:!1,hide_raw:!1,tabs_css:[],header_css:"",stack_css:"",header_text_css:"",active_tab_css:"",options_list_css:"",menu_css:"",options_css:"",voice_css:"",all_tabs_css:"",tab_container_css:"",view_css:"",panel_view_css:"",template_variables:"",exceptions:[]},L=()=>{let t={...A,..._.config.custom_header};const o=(t={...t,...x(t)}).template_variables;delete t.template_variables;const n=()=>{t.hide_tabs&&(t.hide_tabs=q(t.hide_tabs)),t.show_tabs&&(t.show_tabs=q(t.show_tabs)),t.show_tabs&&t.show_tabs.length&&(t.hide_tabs=(e=>{if(e&&e.length){const t=[];for(let e=0;e<f.tabs.length;e+=1)t.push(e);return t.filter(t=>!e.includes(t))}})(t.show_tabs)),(t.disable_sidebar||t.menu_dropdown)&&(t.menu_hide=!0),t.voice_dropdown&&(t.voice_hide=!0),t.kiosk_mode&&!t.disabled_mode?E(!1):D(t)},r=JSON.stringify(t),a=!!o||r.includes("{{")||r.includes("{%");let i;a?i=((t,o,n)=>{const r=y.connection,a={user:y.user.name,browser:navigator.userAgent,...o.variables,...e(n)},i=o.template,s=o.entity_ids;return r.subscribeMessage(e=>t(e.result),{type:"render_template",template:i,variables:a,entity_ids:s})})(e=>{if(window.customHeaderLastTemplateResult!=e){window.customHeaderLastTemplateResult=e;try{t=JSON.parse(e.replace(/"true"/gi,"true").replace(/"false"/gi,"false").replace(/""/,""))}catch(t){console.log(`[CUSTOM-HEADER] There was an issue with the template: ${((e,t)=>{const o=t.toString().match(/\d+/g)[0],n=e.substr(0,o).match(/[^,]*$/),r=e.substr(o).match(/^[^,]*/);return`${n?n[0]:""}${r?r[0]:""}`.replace('":"',': "')})(e,t)}`)}n()}},{template:JSON.stringify(o).replace(/\\/g,"")+JSON.stringify(t).replace(/\\/g,"")},t.locale):n();let s=!1;(async()=>{try{await i}catch(e){s=!0,console.log("[CUSTOM-HEADER] There was an error with one or more of your templates:"),console.log(`${e.message.substring(0,e.message.indexOf(")"))})`)}})(),a&&window.setTimeout(()=>{s||((async()=>{const e=await i;i=void 0,await e()})(),L())},1e3*(60-(new Date).getSeconds()))};L(),(()=>{const e=new MutationObserver(e=>{const t=window.customHeaderConfig;e.forEach(({addedNodes:e,target:o})=>{e.length&&"PARTIAL-PANEL-RESOLVER"==o.nodeName?L():"edit-mode"===o.className&&e.length?(window.customHeaderDisabled||R(t,M,!0),M.menu.style.display="none",w.querySelector("ch-header").style.display="none",f.appHeader.style.display="block",window.scrollTo({top:0,behavior:"smooth"}),w.querySelector("#ch_view_style")&&w.querySelector("#ch_view_style").remove()):"APP-HEADER"===o.nodeName&&e.length&&(L(),f.appHeader.style.display="none",M.menu.style.display="",w.querySelector("ch-header").style.display="")})});e.observe(f.partialPanelResolver,{childList:!0}),e.observe(f.appHeader,{childList:!0})})();
